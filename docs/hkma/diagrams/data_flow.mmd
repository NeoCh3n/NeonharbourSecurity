sequenceDiagram
    participant SIEM as Sentinel/Splunk
    participant Ingest as Lambda Ingest
    participant SF as Step Functions
    participant AI as BedrockAnalyst
    participant DDB as DynamoDB
    participant S3 as S3 Buckets

    SIEM->>Ingest: AgenticAlert event
    Ingest->>DDB: PutItem (stage=received)
    Ingest->>SF: StartExecution
    SF->>DDB: Get investigation context
    SF->>AI: Summarize investigation
    AI-->>SF: Summary + recommendations
    SF->>DDB: Update risk level & metrics
    SF->>S3: Write audit trail JSONL
    SF-->>Ingest: Execution ARN
